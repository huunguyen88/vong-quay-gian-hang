<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vòng Quay Gian Hàng</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background-color: #f0f0f0; }
    .card { background: white; padding: 20px; border-radius: 16px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); margin-bottom: 20px; }
    .button { padding: 10px 20px; font-size: 16px; background-color: #007bff; color: white; border: none; border-radius: 8px; cursor: pointer; }
    .button:disabled { background-color: #ccc; cursor: not-allowed; }
    .reset { background-color: #dc3545; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
    th { background-color: #f2f2f2; }
    input { padding: 8px; width: 100%; margin-bottom: 10px; border-radius: 8px; border: 1px solid #ccc; }
  </style>
</head>
<body>
  <div class="card">
    <h2>Vòng Quay Gian Hàng</h2>
    <input type="text" id="nameInput" placeholder="Nhập tên của bạn" />
    <button id="spinButton" class="button">Quay Vòng</button>
    <button id="resetButton" class="button reset">Reset Dữ Liệu</button>
    <p id="result">Kết quả sẽ hiển thị ở đây.</p>
  </div>

  <div class="card">
    <h3>Kết Quả Đã Quay</h3>
    <table>
      <thead>
        <tr>
          <th>Tên Đối Tác</th>
          <th>Gian Hàng</th>
        </tr>
      </thead>
      <tbody id="resultTable"></tbody>
    </table>
  </div>

  <div class="card">
    <h3>Gian Hàng Còn Lại</h3>
    <p id="remainingBooths"></p>
  </div>

  <script>
    const boothPositions = [
      "Gian hàng 1", "Gian hàng 2", "Gian hàng 3", "Gian hàng 4",
      "Gian hàng 5", "Gian hàng 6", "Gian hàng 7", "Gian hàng 8",
      "Gian hàng 9", "Gian hàng 10", "Gian hàng 11", "Gian hàng 12",
      "Gian hàng 13", "Gian hàng 14", "Gian hàng 15", "Gian hàng 16"
    ];

    let remainingBooths = JSON.parse(localStorage.getItem("remainingBooths")) || [...boothPositions];
    let results = JSON.parse(localStorage.getItem("results")) || [];

    const nameInput = document.getElementById("nameInput");
    const resultText = document.getElementById("result");
    const resultTable = document.getElementById("resultTable");
    const remainingText = document.getElementById("remainingBooths");
    const spinButton = document.getElementById("spinButton");
    const resetButton = document.getElementById("resetButton");

    function updateLocalStorage() {
      localStorage.setItem("remainingBooths", JSON.stringify(remainingBooths));
      localStorage.setItem("results", JSON.stringify(results));
    }

    function updateRemainingText() {
      remainingText.textContent = remainingBooths.length > 0 ? remainingBooths.join(", ") : "Đã hết gian hàng.";
    }

    function updateResultTable() {
      resultTable.innerHTML = results.map(r => `<tr><td>${r.name}</td><td>${r.booth}</td></tr>`).join("");
    }

    spinButton.addEventListener("click", () => {
      const name = nameInput.value.trim();
      if (!name) {
        alert("Vui lòng nhập tên trước khi quay!");
        return;
      }

      if (remainingBooths.length === 0) {
        alert("Tất cả gian hàng đã được chọn.");
        return;
      }

      const randomIndex = Math.floor(Math.random() * remainingBooths.length);
      const selectedBooth = remainingBooths[randomIndex];

      results.push({ name, booth: selectedBooth });
      remainingBooths.splice(randomIndex, 1);

      resultText.textContent = `${name} đã nhận ${selectedBooth}`;
      nameInput.value = "";

      updateResultTable();
      updateRemainingText();
      updateLocalStorage();

      if (remainingBooths.length === 0) {
        spinButton.disabled = true;
      }
    });

    resetButton.addEventListener("click", () => {
      const password = prompt("Nhập mật khẩu để reset dữ liệu:");
      if (password === "matkhaula123") {
        if (confirm("Bạn có chắc chắn muốn reset dữ liệu?")) {
          remainingBooths = [...boothPositions];
          results = [];
          updateResultTable();
          updateRemainingText();
          localStorage.clear();
          resultText.textContent = "Dữ liệu đã được reset.";
          spinButton.disabled = false;
        }
      } else {
        alert("Mật khẩu không đúng!");
      }
    });

    updateResultTable();
    updateRemainingText();
  </script>
</body>
</html>
